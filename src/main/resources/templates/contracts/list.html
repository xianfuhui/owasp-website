<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>Danh sách hợp đồng</title>
</head>
<div th:replace="~{fragments/navbar :: navbar}"></div>
<body>

    <h2>Danh sách hợp đồng</h2>

    <!-- Form upload file (chỉ hiện với ADMIN) -->
    <form sec:authorize="hasRole('ADMIN')" 
          th:action="@{'/contracts/upload/' + ${employeeId}}" 
          method="post" enctype="multipart/form-data">
        <input type="file" name="file" required>
        <button type="submit">Upload</button>
    </form>

    <!-- Bảng danh sách hợp đồng -->
    <table>
        <thead>
            <tr>
                <th>Tên file</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="c : ${contracts}">
                <td th:text="${c.fileName}"></td>
                <td>
                    <a th:href="@{'/contracts/view/' + ${c.id}}" target="_blank">Xem</a>
                    <a th:href="@{'/contracts/download/' + ${c.id}}">Tải</a>
                    <a sec:authorize="hasRole('ADMIN')" 
                       th:href="@{'/contracts/delete/' + ${c.id}}"
                       onclick="return confirm('Bạn có chắc muốn xóa file này?');">Xóa</a>
                </td>
            </tr>
            <tr th:if="${#lists.isEmpty(contracts)}">
                <td colspan="2">Chưa có hợp đồng nào.</td>
            </tr>
        </tbody>
    </table>

    <div th:replace="~{fragments/messages :: messages}"></div>

</body>

</html>
