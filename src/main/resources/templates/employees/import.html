<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import nhân viên - HR Management</title>
    <link rel="stylesheet" th:href="@{/css/global.css}">
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
    <style>
        .page-container {
            padding: var(--spacing-2xl) 0;
        }

        .page-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .page-title .icon {
            width: 2rem;
            height: 2rem;
            color: var(--color-primary);
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: 0.9375rem;
            color: var(--color-text-tertiary);
            margin-bottom: var(--spacing-2xl);
        }

        .breadcrumb a {
            color: var(--color-primary);
        }

        .import-container {
            max-width: 700px;
            margin: 0 auto;
        }

        .upload-card {
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            padding: var(--spacing-2xl);
            box-shadow: var(--shadow-md);
            text-align: center;
        }

        .upload-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--spacing-lg);
            padding: var(--spacing-lg);
            background: linear-gradient(135deg, var(--color-primary-lighter) 0%, var(--color-accent-light) 100%);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .upload-icon img {
            width: 100%;
            height: 100%;
            color: var(--color-primary);
        }

        .upload-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .upload-desc {
            color: var(--color-text-secondary);
            margin-bottom: var(--spacing-xl);
        }

        .file-drop-zone {
            border: 2px dashed var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-2xl);
            margin-bottom: var(--spacing-lg);
            background: var(--color-border-light);
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .file-drop-zone:hover {
            border-color: var(--color-primary);
            background: rgba(70, 130, 180, 0.05);
        }

        .file-drop-zone.dragover {
            border-color: var(--color-primary);
            background: rgba(70, 130, 180, 0.1);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: 0.875rem 1.5rem;
            background: var(--color-primary);
            color: white;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 500;
        }

        .file-input-label:hover {
            background: var(--color-primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .selected-file {
            margin-top: var(--spacing-md);
            padding: var(--spacing-md);
            background: var(--color-surface);
            border-radius: var(--radius-md);
            display: none;
        }

        .selected-file.show {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: var(--color-success-light);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .file-info {
            flex: 1;
            text-align: left;
        }

        .file-name {
            font-weight: 600;
            color: var(--color-text-primary);
        }

        .file-size {
            font-size: 0.875rem;
            color: var(--color-text-tertiary);
        }

        .instructions-card {
            background: var(--color-info-light);
            border-left: 4px solid var(--color-info);
            border-radius: var(--radius-md);
            padding: var(--spacing-lg);
            margin-top: var(--spacing-xl);
        }

        .instructions-title {
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: var(--spacing-sm);
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .instructions-list {
            margin: 0;
            padding-left: var(--spacing-lg);
            color: var(--color-text-secondary);
        }

        .instructions-list li {
            margin-bottom: var(--spacing-xs);
        }

        .action-buttons {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
            margin-top: var(--spacing-xl);
        }

        @media (max-width: 768px) {
            .action-buttons {
                flex-direction: column;
            }

            .action-buttons .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div th:replace="~{fragments/navbar :: navbar}"></div>
    <div th:replace="~{fragments/messages :: messages}"></div>

    <div class="container page-container">
        <h1 class="page-title">
            <img th:src="@{/icons/upload.svg}" alt="" class="icon">
            <span>Import nhân viên từ Excel</span>
        </h1>
        <div class="breadcrumb">
            <a th:href="@{/home}">Trang chủ</a>
            <span>/</span>
            <a th:href="@{/employees/list}">Nhân viên</a>
            <span>/</span>
            <span>Import</span>
        </div>

        <div class="import-container">
            <div class="upload-card">
                <div class="upload-icon">
                    <img th:src="@{/icons/upload.svg}" alt="">
                </div>
                <h2 class="upload-title">Tải lên file Excel</h2>
                <p class="upload-desc">Chọn file Excel (.xlsx, .xls) chứa danh sách nhân viên</p>

                <form method="post" enctype="multipart/form-data" id="importForm">
                    <div class="file-drop-zone" id="dropZone">
                        <div class="file-input-wrapper">
                            <input type="file" name="file" id="fileInput" accept=".xlsx,.xls" required onchange="handleFileSelect(event)">
                            <label for="fileInput" class="file-input-label">
                                <img th:src="@{/icons/file-text.svg}" alt="" class="icon">
                                <span>Chọn file Excel</span>
                            </label>
                        </div>
                        <p style="margin-top: var(--spacing-md); color: var(--color-text-tertiary); font-size: 0.875rem;">
                            hoặc kéo thả file vào đây
                        </p>
                    </div>

                    <div class="selected-file" id="selectedFile">
                        <div class="file-icon">
                            <img th:src="@{/icons/file-text.svg}" alt="" class="icon" style="color: var(--color-success);">
                        </div>
                        <div class="file-info">
                            <div class="file-name" id="fileName">file.xlsx</div>
                            <div class="file-size" id="fileSize">0 KB</div>
                        </div>
                        <button type="button" onclick="clearFile()" class="btn btn-sm btn-outline">
                            <img th:src="@{/icons/trash.svg}" alt="" class="icon">
                        </button>
                    </div>

                    <div class="action-buttons">
                        <a th:href="@{/employees/list}" class="btn btn-outline">
                            <span>Hủy bỏ</span>
                        </a>
                        <button type="submit" class="btn btn-primary" id="submitBtn" disabled>
                            <img th:src="@{/icons/upload.svg}" alt="" class="icon">
                            <span>Import danh sách</span>
                        </button>
                    </div>
                </form>
            </div>

            <div class="instructions-card">
                <div class="instructions-title">
                    <img th:src="@{/icons/alert-circle.svg}" alt="" class="icon" style="color: var(--color-info);">
                    <span>Hướng dẫn</span>
                </div>
                <ul class="instructions-list">
                    <li>File Excel phải có định dạng .xlsx hoặc .xls</li>
                    <li>Dòng đầu tiên là tiêu đề các cột</li>
                    <li>Các cột bắt buộc: Họ tên, Email, Số điện thoại, Chức vụ, Lương</li>
                    <li>Đảm bảo dữ liệu đầy đủ và chính xác trước khi import</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const selectedFile = document.getElementById('selectedFile');
        const submitBtn = document.getElementById('submitBtn');

        // Drag and drop handlers
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                fileInput.files = files;
                handleFileSelect({ target: { files: files } });
            }
        });

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                document.getElementById('fileName').textContent = file.name;
                document.getElementById('fileSize').textContent = formatFileSize(file.size);
                selectedFile.classList.add('show');
                submitBtn.disabled = false;
            }
        }

        function clearFile() {
            fileInput.value = '';
            selectedFile.classList.remove('show');
            submitBtn.disabled = true;
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
    </script>
</body>
</html>